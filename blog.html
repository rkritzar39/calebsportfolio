<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Blog</title>
    <!-- Main Stylesheets -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="blog.css"> <!-- The new "Awesome Theme" stylesheet -->
    <link rel="stylesheet" href="settings.css">

    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body class="dark-mode">

    <!-- Header Section -->
    <header class="main-header">
        <h1>My Awesome Blog</h1>
        <a href="index.html" class="home-link">
            <i class="fas fa-home"></i> Back to Main Site
        </a>
    </header>

    <!-- Main Blog Content Container -->
    <main class="blog-container">

        <!-- Search and Filter Controls -->
        <section class="filter-controls">
            <!-- This wrapper is the key to positioning the icon -->
            <div class="search-wrapper">
                <input type="text" id="search-input" class="search-input" placeholder="Search posts...">
                <i class="fas fa-search search-icon"></i>
            </div>
            <div id="category-filters" class="category-filters">
                <!-- JavaScript will inject category buttons here -->
            </div>
        </section>

        <!-- Featured Post Section -->
        <section id="featured-post-container" class="featured-post-container">
            <!-- JavaScript will inject the featured post here -->
        </section>

        <!-- Title for the main post grid -->
        <h2 class="section-title">All Posts</h2>

        <!-- Grid for displaying all other posts -->
        <section id="posts-grid" class="posts-grid">
            <!-- JavaScript will inject post cards here -->
        </section>

    </main>

    <!-- Main Scripts -->
    <!-- Make sure firebase-init.js is loaded first if it exports the db instance -->
    <script type="module" src="firebase-init.js"></script> 
    <script type="module" src="displayShoutouts.js"></script>
    <script src="common.js"></script>
    <script src="settings.js"></script>
    <!-- iOS 26 Floating Toolbar with Liquid Highlight -->
<nav class="ios26-toolbar" id="ios26-toolbar">
  <div class="tab-highlight" id="tab-highlight"></div>

  <a href="index.html" class="toolbar-item" data-color="#007aff">
    <i class="fa-solid fa-house"></i>
    <span>Home</span>
  </a>

  <a href="blog.html" class="toolbar-item active" data-color="#e63946">
    <i class="fa-solid fa-pen-nib"></i>
    <span>Blog</span>
  </a>

  <a href="merchandise.html" class="toolbar-item" data-color="#ff9500">
    <i class="fa-solid fa-shirt"></i>
    <span>Merch</span>
  </a>

  <a href="settings.html" class="toolbar-item" data-color="#34c759">
    <i class="fa-solid fa-gear"></i>
    <span>Settings</span>
  </a>
</nav>
    
<script>
const toolbar = document.getElementById("ios26-toolbar");
const items = toolbar.querySelectorAll(".toolbar-item");
const highlight = document.getElementById("tab-highlight");

let lastScrollY = window.scrollY;
let isDragging = false;
let currentHover = toolbar.querySelector(".toolbar-item.active");
let startX = 0, currentX = 0, dragStretch = 0;

// --- helper to move highlight ---
function moveHighlightTo(el, stretch = 1) {
  const rect = el.getBoundingClientRect();
  const parent = toolbar.getBoundingClientRect();
  const centerX = rect.left - parent.left + rect.width / 2;
  const x = centerX - highlight.offsetWidth / 2;
  highlight.style.left = `${x}px`;
  highlight.style.width = `${70 * stretch}px`;
}

// --- initialize position ---
if (currentHover) moveHighlightTo(currentHover);

// --- hide/show on scroll ---
window.addEventListener("scroll", () => {
  if (window.scrollY > lastScrollY && window.scrollY > 100) {
    toolbar.classList.add("hide");
  } else {
    toolbar.classList.remove("hide");
  }
  lastScrollY = window.scrollY;
});

// --- interactive drag ---
items.forEach(item => {
  const color = item.dataset.color;

  item.addEventListener("pointerdown", e => {
    isDragging = true;
    startX = e.clientX;
    currentX = startX;
    highlight.classList.add("stretching");
    item.classList.add("drag-over");
    item.style.setProperty("--hover-color", color);
  });

  item.addEventListener("pointerenter", e => {
    if (isDragging) {
      items.forEach(i => i.classList.remove("drag-over"));
      item.classList.add("drag-over");
      item.style.setProperty("--hover-color", color);
      currentHover = item;
    }
  });

  item.addEventListener("pointerup", e => {
    finalizeSelection();
  });
});

window.addEventListener("pointermove", e => {
  if (!isDragging) return;
  currentX = e.clientX;
  const delta = Math.abs(currentX - startX);
  const stretch = Math.min(1 + delta / 150, 1.35); // elastic factor
  moveHighlightTo(currentHover, stretch);
});

window.addEventListener("pointerup", finalizeSelection);

function finalizeSelection() {
  if (!isDragging) return;
  isDragging = false;
  highlight.classList.remove("stretching");
  highlight.style.transition = "all 0.35s cubic-bezier(0.25,1,0.5,1)";
  moveHighlightTo(currentHover, 1);

  items.forEach(i => i.classList.remove("active", "drag-over"));
  if (currentHover) {
    currentHover.classList.add("active");
    currentHover.style.setProperty("--active-color", currentHover.dataset.color);
    setTimeout(() => (window.location.href = currentHover.href), 180);
  }
}
</script>
</body>
</html>
