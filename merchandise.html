<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Shop official Bus Army Dude merchandise. View what's in stock, on sale, and coming soon.">
    <title>Merchandise - Caleb's Profile</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="ai-features.css">
    <link rel="stylesheet" href="settings.css">
    <link rel="stylesheet" href="theme-overrides.css">
    <link rel="stylesheet" href="merchandise.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-E0RSQS1MS7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-E0RSQS1MS7');
    </script>
    
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
    <meta name="theme-color" content="#ffffff"/>
</head>   
<body class="dark-mode">

<div id="maintenanceModeMessage" style="display: none; background-color: var(--bg-color); color: var(--text-color); text-align: center; padding: 30px; border: 2px solid var(--accent-color); border-radius: 16px; box-shadow: 0 8px 20px var(--shadow-color); margin: 20px;">
    <h2 style="color: var(--accent-color); font-family: 'Inter', sans-serif; font-size: 2em; margin-bottom: 20px;">We're Performing Some Upgrades!</h2>
    <p style="font-family: 'Roboto', sans-serif; font-size: 1.2em; line-height: 1.6; margin-bottom: 20px;">
        Our website is currently undergoing scheduled maintenance to improve your experience. We’re making some big updates, so things will be smoother, faster, and even better when we're done.
    </p>
    <p style="font-family: 'Roboto', sans-serif; font-size: 1.2em; line-height: 1.6; margin-bottom: 20px;">
        During this time, certain features may be temporarily unavailable, and you might not be able to access all parts of the site. But don’t worry, we’re working hard to get everything back up and running as quickly as possible.
    </p>
    <p style="font-family: 'Roboto', sans-serif; font-size: 1.2em; line-height: 1.6; margin-bottom: 20px;">
        Please check back soon, or follow our social media pages for updates on when we’ll be live again. We appreciate your patience and can’t wait to show you what’s new!
    </p>
    <p style="font-family: 'Roboto', sans-serif; font-size: 1.3em; font-weight: bold;">
        Thank you for your understanding!
    </p>
</div>
    
    <header>
        <div class="header-content">
            <h1>Merchandise</h1>
                <button class="home-button" onclick="window.location.href='/'">Home</button>
        </div>
    </header>

    <div class="category-dropdown">
        <label for="categories">Categories:</label>
        <select id="categories" name="categories">
            </select>
    </div>

    <h2 id="section-title">All Products</h2>
    <p id="product-count">0 products</p>

    <div id="product-grid" class="product-grid"></div>

    <footer>
        <p>© <span id="year"></span> Caleb Kritzar. All Rights Reserved.</p>
    </footer>

    <script src="common.js"></script>
    <script src="globalSettings.js"></script>
    <script src="script.js"></script>
    <script src="ai-features.js"></script>
    <script src="settings.js"></script>
    <script src="merchandise.js"></script> 

   <!-- iOS 19 Liquid Bubble Toolbar -->
<nav class="ios19-bubble-toolbar" role="tablist" aria-label="Primary">
  <a class="tab" href="index.html" data-accent="#ff3b30" role="tab" aria-selected="false">
    <i class="fa-solid fa-house"></i><span>Home</span>
  </a>
  <a class="tab" href="merchandise.html" data-accent="#34c759" role="tab" aria-selected="false">
    <i class="fa-solid fa-bag-shopping"></i><span>Merch</span>
  </a>
  <a class="tab" href="settings.html" data-accent="#0a84ff" role="tab" aria-selected="false">
    <i class="fa-solid fa-gear"></i><span>Settings</span>
  </a>

  <!-- The draggable liquid capsule -->
  <div class="bubble-capsule" aria-hidden="true"></div>
</nav>

<!-- Icons -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/js/all.min.js" defer></script>

<script>
/* ===============================
   iOS 19 Liquid Bubble Controller
   =============================== */
(() => {
  const toolbar = document.querySelector('.ios19-bubble-toolbar');
  const tabs = [...toolbar.querySelectorAll('.tab')];
  const capsule = toolbar.querySelector('.bubble-capsule');

  // Active by URL
  const current = location.pathname.split('/').pop() || 'index.html';
  let activeIndex = Math.max(0, tabs.findIndex(t => t.getAttribute('href') === current));
  if (activeIndex < 0) activeIndex = 0;

  // Layout helpers
  const rects = () => tabs.map(t => t.getBoundingClientRect());
  const tw = () => toolbar.getBoundingClientRect().width;
  const capW = () => Math.min(148, Math.max(120, Math.floor(tw()/tabs.length - 16)));
  const capH = 46;

  // Place capsule under active tab
  function placeCapsule(index, animate=true) {
    const R = rects();
    const r = R[index];
    const left = r.left - toolbar.getBoundingClientRect().left + r.width/2 - capW()/2;
    capsule.style.setProperty('--cap-x', `${left}px`);
    capsule.style.setProperty('--cap-w', `${capW()}px`);
    capsule.style.setProperty('--cap-h', `${capH}px`);
    capsule.style.setProperty('--cap-accent', tabs[index].dataset.accent || '#0a84ff');

    tabs.forEach((t,i) => {
      t.classList.toggle('active', i === index);
      t.setAttribute('aria-selected', i === index ? 'true' : 'false');
    });

    if (animate) {
      capsule.classList.remove('pop');
      // Force reflow to restart animation
      void capsule.offsetWidth;
      capsule.classList.add('pop');
    }
  }

  // Interpolate accent while dragging
  function lerpColor(a, b, t) {
    const ah = a.replace('#',''), bh = b.replace('#','');
    const ar = parseInt(ah.substr(0,2),16), ag = parseInt(ah.substr(2,2),16), ab = parseInt(ah.substr(4,2),16);
    const br = parseInt(bh.substr(0,2),16), bg = parseInt(bh.substr(2,2),16), bb = parseInt(bh.substr(4,2),16);
    const rr = Math.round(ar+(br-ar)*t), rg = Math.round(ag+(bg-ag)*t), rb = Math.round(ab+(bb-ab)*t);
    return `#${rr.toString(16).padStart(2,'0')}${rg.toString(16).padStart(2,'0')}${rb.toString(16).padStart(2,'0')}`;
  }

  // Drag logic
  let dragging = false, startX = 0, startLeft = 0;

  function xToIndex(x) {
    const R = rects();
    const centers = R.map(r => r.left + r.width/2);
    let nearest = 0, min = Infinity;
    centers.forEach((c,i) => { const d = Math.abs(x - c); if (d < min) { min = d; nearest = i; } });
    return nearest;
  }

  function onDown(e){
    const p = e.touches ? e.touches[0] : e;
    dragging = true;
    startX = p.clientX;
    startLeft = parseFloat(getComputedStyle(capsule).getPropertyValue('--cap-x')) || 0;
    capsule.classList.add('dragging');
    e.preventDefault();
  }
  function onMove(e){
    if (!dragging) return;
    const p = e.touches ? e.touches[0] : e;
    const dx = p.clientX - startX;
    const maxLeft = tw() - capW();
    let newLeft = Math.min(maxLeft, Math.max(0, startLeft + dx));
    capsule.style.setProperty('--cap-x', `${newLeft}px`);

    // Determine fractional position between tabs for color crossfade
    const R = rects();
    const centers = R.map(r => r.left + r.width/2 - toolbar.getBoundingClientRect().left);
    // Find surrounding indices
    let i = centers.findIndex(c => newLeft + capW()/2 < c);
    if (i === -1) i = centers.length - 1;
    const prev = Math.max(0, i-1), next = i;
    const a = centers[prev], b = centers[next];
    const t = b === a ? 0 : (newLeft + capW()/2 - a) / (b - a);
    const ca = tabs[prev].dataset.accent || '#ff3b30';
    const cb = tabs[next].dataset.accent || '#0a84ff';
    capsule.style.setProperty('--cap-accent', lerpColor(ca, cb, Math.min(1, Math.max(0, t))));
  }
  function onUp(e){
    if (!dragging) return;
    dragging = false;
    capsule.classList.remove('dragging');

    // Snap to nearest tab
    const centerX = (parseFloat(getComputedStyle(capsule).getPropertyValue('--cap-x')) || 0) + capW()/2 + toolbar.getBoundingClientRect().left;
    const idx = xToIndex(centerX);
    activeIndex = idx;
    placeCapsule(idx, true);

    // Navigate after snap
    setTimeout(() => { location.href = tabs[idx].getAttribute('href'); }, 140);
  }

  // Tap -> pop + move
  tabs.forEach((t, i) => {
    t.addEventListener('click', (e) => {
      e.preventDefault();
      activeIndex = i;
      placeCapsule(i, true);
      setTimeout(() => { location.href = t.getAttribute('href'); }, 140);
    }, {passive:false});
  });

  // Pointer hooks
  capsule.addEventListener('touchstart', onDown, {passive:false});
  capsule.addEventListener('mousedown', onDown);
  window.addEventListener('touchmove', onMove, {passive:false});
  window.addEventListener('mousemove', onMove);
  window.addEventListener('touchend', onUp);
  window.addEventListener('mouseup', onUp);
  window.addEventListener('resize', () => placeCapsule(activeIndex, false));

  // Initial paint
  requestAnimationFrame(() => placeCapsule(activeIndex, false));
})();
</script>
</body>
</html>
