:root{
  /* === Onyx (macOS/iOS 26 Inspired) Theme Defaults === */
  --font-size-base: 16px;

  /* Accent */
  --accent-color: #007aff;
  --accent-text-color: #fff;

  /* Light */
  --light-bg: #f2f2f7;
  --light-content-bg: #fff;
  --light-text: #000;
  --light-secondary-text: #8a8a8e;
  --light-border: #c6c6c8;
  --light-hover: rgba(0,0,0,0.05);
  --light-toggle-off: #e9e9eb;
  --light-red: #ff3b30;

  /* Dark */
  --dark-bg: #000;
  --dark-content-bg: #1c1c1e;
  --dark-text: #fff;
  --dark-secondary-text: #8d8d93;
  --dark-border: #38383a;
  --dark-hover: rgba(255,255,255,0.1);
  --dark-toggle-off: #39393d;
  --dark-red: #ff453a;

  /* runtime tokens (default to light) */
  --bg-color: var(--light-bg);
  --content-bg: var(--light-content-bg);
  --text-color: var(--light-text);
  --secondary-text: var(--light-secondary-text);
  --border-color: var(--light-border);
  --hover-color: var(--light-hover);
  --toggle-on: var(--accent-color);
  --toggle-off: var(--light-toggle-off);
  --red-color: var(--light-red);
  --slider-track-color: #e9e9eb;
  --slider-track-filled-color: var(--accent-color);
  --slider-thumb-color: #fff;

  /* shadows */
  --shadow-elevation-1: 0 1px 2px rgba(0,0,0,0.08);
  --shadow-elevation-2: 0 6px 20px rgba(0,0,0,0.12);

  /* glass */
  --glass-blur: blur(18px) saturate(140%) brightness(1.03); /* reduced for perf */
  --glass-bg-light: rgba(242,242,247,0.82);
  --glass-border-light: rgba(0,0,0,0.08);
  --glass-bg-dark: rgba(28,28,30,0.78);
  --glass-border-dark: rgba(255,255,255,0.12);

  /* accessibility tuning */
  --focus-outline: 0.125rem solid rgba(0,122,255,0.9);
}

/* Dark mode overrides */
body.dark-mode {
  --bg-color: var(--dark-bg);
  --content-bg: var(--dark-content-bg);
  --text-color: var(--dark-text);
  --secondary-text: var(--dark-secondary-text);
  --border-color: var(--dark-border);
  --hover-color: var(--dark-hover);
  --toggle-off: var(--dark-toggle-off);
  --red-color: var(--dark-red);
  --glass-bg-light: var(--glass-bg-dark);
  --glass-border-light: var(--glass-border-dark);

  /* shadow tuning in dark */
  --shadow-elevation-1: 0 1px 2px rgba(0,0,0,0.3);
  --shadow-elevation-2: 0 12px 28px rgba(0,0,0,0.35);
}

/* High-contrast profile */
body.high-contrast{
  --accent-color: #ffcc00;
  --accent-text-color: #000;
  --text-color: #fff;
  --secondary-text: rgba(255,255,255,0.92);
  --border-color: rgba(255,255,255,0.6);
  --glass-blur: blur(10px) saturate(180%);
}

/* Base */
html,body{height:100%}
body{
  font-family:-apple-system, BlinkMacSystemFont, "SF Pro Text","Helvetica Neue","Roboto",sans-serif;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  background:var(--bg-color);
  color:var(--text-color);
  font-size:var(--font-size-base);
  line-height:1.4;
  margin:0; padding:0;
  -webkit-tap-highlight-color: transparent;
}

/* ===== Reusable glass card (consolidated) ===== */
.glass-card,
.settings-header,
.settings-subsection,
footer,
#cookie-consent-banner{
  background: color-mix(in srgb, var(--glass-bg-light) 98%, transparent);
  border-radius: 1.5rem;
  border: 1px solid var(--glass-border-light);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.18), var(--shadow-elevation-1);
  transition: background .18s ease, box-shadow .18s ease, transform .18s ease;
}
body.dark-mode .glass-card,
body.dark-mode .settings-subsection,
body.dark-mode footer,
body.dark-mode #cookie-consent-banner{
  background: color-mix(in srgb, var(--glass-bg-dark) 92%, transparent);
  border: 1px solid var(--glass-border-dark);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.08), var(--shadow-elevation-2);
}

/* Settings page layout */
body.settings-page .container{max-width:57.5rem;margin:0 auto;padding:1.875rem 1.25rem}
.settings-header{display:flex;justify-content:space-between;align-items:center;padding:1rem 1.25rem;margin-bottom:1.875rem}
.settings-header h1{font-size:1.5rem;font-weight:600;margin:0;color:var(--text-color)}
.version{font-size:.8125rem;color:var(--secondary-text);background-color:var(--border-color);padding:.1875rem .5rem;border-radius:.375rem}

/* subsection */
.settings-subsection{border-radius:1rem;margin-bottom:1.5rem;overflow:hidden}
.subsection-title{font-size:.8125rem;font-weight:600;padding:.75rem 1.25rem;margin:0;text-transform:uppercase;color:var(--secondary-text);border-bottom:1px solid var(--border-color)}

/* setting card */
.setting-card{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.25rem;min-height:3.5rem;border-bottom:1px solid var(--border-color);gap:1rem;position:relative;overflow:hidden;transition:background-color .18s ease, box-shadow .18s ease}
.setting-card:last-child{border-bottom:0}
.setting-card:hover{background-color: color-mix(in srgb, var(--bg-color) 50%, var(--content-bg));box-shadow:var(--shadow-elevation-2)}

.setting-label{flex:1;padding-right:.75rem}
.setting-title{font-size:.9375rem;font-weight:500;margin:0 0 .25rem 0}
.setting-description{font-size:.8125rem;color:var(--secondary-text);margin:0}

/* icon container (left-side icons) - accent-aware */
.setting-icon-container{
  width:29px;height:29px;border-radius:7px;display:flex;align-items:center;justify-content:center;flex-shrink:0;
  color:var(--accent-text-color);font-size:15px;
  /* subtle glass mix so icon background isn't flat */
  background: color-mix(in srgb, var(--accent-color) 32%, var(--glass-bg-light));
  border: 1px solid color-mix(in srgb, var(--accent-color) 32%, transparent);
  box-shadow: 0 2px 6px rgba(0,0,0,0.12), inset 0 1px 0 rgba(255,255,255,0.08);
  transition: transform .18s ease, box-shadow .18s ease, background .18s ease;
}

/* If you want a neutral icon square (not accented) add .neutral */
.setting-icon-container.neutral{
  background: color-mix(in srgb, var(--content-bg) 92%, transparent);
  color: var(--secondary-text);
  border-color: var(--border-color);
  box-shadow: 0 1px 2px rgba(0,0,0,0.06);
}

/* Ensure glyphs follow color and sizing */
.setting-icon-container svg,
.setting-icon-container i,
.setting-icon-container img{
  width: 16px; height: 16px; display:block;color:currentColor;fill:currentColor;stroke:currentColor;
  pointer-events:none;
}

/* variant where icon background uses a lighter tint of accent (good for dark-mode readability) */
body.dark-mode .setting-icon-container{
  background: color-mix(in srgb, var(--accent-color) 28%, var(--glass-bg-dark));
  border-color: color-mix(in srgb, var(--accent-color) 22%, var(--glass-border-dark));
}

/* Chevron (navigation arrow) */
.chevron{color:var(--secondary-text);opacity:.6;font-size:1.25rem;margin-left:.75rem}

/* Segmented control (consolidated) */
.segmented-control{position:relative;display:flex;align-items:center;background:color-mix(in srgb,var(--content-bg) 60%,transparent);border-radius:999px;padding:.125rem;backdrop-filter:var(--glass-blur);-webkit-backdrop-filter:var(--glass-blur);border:1px solid color-mix(in srgb,var(--accent-color) 15%,transparent);box-shadow:inset 0 0 0 1px rgba(255,255,255,.12)}
.segmented-control button{flex:1;border:0;background:transparent;padding:.35rem .75rem;font-weight:600;font-size:.8125rem;color:var(--text-color);cursor:pointer}
.segmented-control .seg-bg{position:absolute;top:3px;bottom:3px;left:3px;width:calc(33% - 6px);border-radius:999px;background:color-mix(in srgb,var(--accent-color) 35%,var(--content-bg));box-shadow:0 6px 14px color-mix(in srgb,var(--accent-color) 25%,rgba(0,0,0,.18));transition:left .28s cubic-bezier(.22,.9,.22,1),width .28s cubic-bezier(.22,.9,.22,1)}

/* Toggle (md-switch) */
.md-switch{position:relative;display:inline-flex;align-items:center;justify-content:flex-end;width:52px;height:32px}
.md-switch input{opacity:0;width:0;height:0}
.md-switch .track{position:absolute;inset:0;border-radius:999px;background:var(--toggle-off);backdrop-filter:blur(8px) saturate(160%);-webkit-backdrop-filter:blur(8px) saturate(160%);box-shadow:inset 0 1px 2px rgba(0,0,0,0.08);transition:background .28s cubic-bezier(.25,.8,.25,1),box-shadow .18s ease}
.md-switch .thumb{position:absolute;top:2px;left:2px;width:28px;height:28px;border-radius:50%;background:rgba(255,255,255,0.9);box-shadow:0 2px 4px rgba(0,0,0,0.12);transition:transform .28s cubic-bezier(.25,.8,.25,1),width .18s ease}
.md-switch:active .thumb{width:30px}
.md-switch input:checked + .track{background:var(--toggle-on);box-shadow:0 0 10px color-mix(in srgb,var(--accent-color) 45%,transparent)}
.md-switch input:checked + .track .thumb{transform:translateX(20px)}

/* Slider (text-size control improved) */
#text-size-slider{appearance:none;width:100%;height:10px;border-radius:999px;background:linear-gradient(to right,var(--accent-color) 0%,var(--accent-color) var(--_fill,0%),var(--slider-track-color) var(--_fill,0%),var(--slider-track-color) 100%);transition:background .12s linear}
#text-size-slider::-webkit-slider-thumb{appearance:none;width:28px;height:28px;border-radius:50%;background:#fff;border:0.5px solid rgba(0,0,0,0.06);box-shadow:inset 0 0 0 1px rgba(255,255,255,.18),0 6px 16px rgba(0,0,0,.12)}
#text-size-slider::-moz-range-thumb{width:28px;height:28px;border-radius:50%;background:#fff;box-shadow:inset 0 0 0 1px rgba(255,255,255,.18),0 6px 16px rgba(0,0,0,.12)}

/* Custom background components (consolidated & responsive) */
.custom-background{display:flex;align-items:flex-start;justify-content:space-between;gap:2rem;flex-wrap:nowrap}
.custom-bg-left{flex:1;display:flex;flex-direction:column;justify-content:flex-start}
.custom-bg-left .setting-label{text-align:left;margin-bottom:.5rem}
.custom-bg-controls{display:flex;align-items:center;gap:.75rem;flex-wrap:nowrap}
#customBgUpload{display:none}
.custom-bg-label{font-size:.8125rem;font-weight:500;color:var(--accent-text-color);padding:.45rem 1rem;border-radius:999px;border:1px solid color-mix(in srgb,var(--accent-color) 40%,transparent);background:color-mix(in srgb,var(--accent-color) 20%,var(--glass-bg-light));backdrop-filter:var(--glass-blur);cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,0.12);transition:transform .14s ease,background .14s ease}
.file-name{font-size:.8125rem;color:var(--secondary-text);max-width:180px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
#removeCustomBg{font-size:.8125rem;padding:.45rem .85rem;border-radius:999px;border:1px solid color-mix(in srgb,var(--accent-color) 50%,transparent);background:color-mix(in srgb,var(--accent-color) 18%,var(--glass-bg-light));color:var(--accent-text-color);cursor:pointer;opacity:0;transition:opacity .25s ease;box-shadow:0 2px 6px rgba(0,0,0,0.12)}
#removeCustomBg.visible{opacity:1}

/* preview bubble */
.custom-bg-right{display:flex;align-items:center;justify-content:center;min-width:120px}
#customBgPreviewContainer{display:none;width:110px;height:110px;border-radius:50%;overflow:hidden;position:relative;background:color-mix(in srgb,var(--glass-bg-light) 85%,transparent);box-shadow:0 3px 10px rgba(0,0,0,0.2),inset 0 0 12px color-mix(in srgb,var(--accent-color) 15%,transparent);backdrop-filter:var(--glass-blur);opacity:0;transform:scale(.96);transition:opacity .34s ease,transform .34s ease}
#customBgPreviewContainer.visible{display:block;opacity:1;transform:scale(1)}
#customBgPreview{width:100%;height:100%;border-radius:50%;object-fit:cover;opacity:0;transition:opacity .34s ease;pointer-events:none;user-select:none}
#customBgPreview.loaded{opacity:1}

/* iOS bubblebar / dock consolidated (kept behavior, cleaned duplication) */
.ios19-bubblebar{position:fixed;left:50%;bottom:1.25rem;transform:translateX(-50%);width:min(500px,calc(100% - 2.5rem));display:grid;grid-template-columns:repeat(3,1fr);align-items:center;padding:.65rem .75rem;border-radius:2rem;z-index:9999;background:var(--glass-bg-light);border:1px solid var(--glass-border-light);backdrop-filter:var(--glass-blur);box-shadow:inset 0 0 0 1px rgba(255,255,255,0.12),var(--shadow-elevation-1);transition:transform .45s cubic-bezier(.22,.9,.22,1),opacity .45s ease}
body.dark-mode .ios19-bubblebar{background:var(--glass-bg-dark);border-color:var(--glass-border-dark);box-shadow:inset 0 0 0 1px rgba(255,255,255,0.08),var(--shadow-elevation-2)}
.ios19-bubblebar .tab{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:.35rem;min-height:3.2rem;font-weight:600;font-size:.86rem;user-select:none;color:var(--secondary-text);transition:color .25s ease}
.ios19-bubblebar .tab i{font-size:1.2rem;color:currentColor;transition:transform .25s ease}
.ios19-bubblebar .tab.active{color:var(--accent-color)} .ios19-bubblebar .tab.active i{transform:translateY(-1px) scale(1.05)}
.bubble{position:absolute;top:6px;bottom:6px;left:var(--x,0);width:var(--w,120px);border-radius:999px;pointer-events:none;background:linear-gradient(160deg, rgba(255,255,255,.25), rgba(255,255,255,.10) 85%);border:1px solid var(--glass-border-light);backdrop-filter:blur(16px) saturate(160%);box-shadow:inset 0 0 1px rgba(255,255,255,.8),inset 0 10px 24px rgba(255,255,255,.18),0 6px 18px rgba(0,0,0,.22);transition:left .25s cubic-bezier(.22,.9,.22,1),width .25s cubic-bezier(.22,.9,.22,1)}
body.dark-mode .bubble{border-color:var(--glass-border-dark);box-shadow:inset 0 0 1px rgba(255,255,255,.6),inset 0 10px 26px rgba(255,255,255,.12),0 8px 22px rgba(0,0,0,.6)}

/* Dock (Onyx) */
.onyx-dock{position:fixed;bottom:16px;left:50%;transform:translateX(-50%);display:flex;gap:22px;padding:8px 22px;border-radius:30px;z-index:9999;background:linear-gradient(to top, rgba(255,255,255,0.12), rgba(255,255,255,0.04)),var(--glass-bg-light);border:1px solid color-mix(in srgb,var(--border-color) 55%,transparent);backdrop-filter:blur(30px) saturate(160%);box-shadow:inset 0 1px 1px rgba(255,255,255,0.12),inset 0 -1px 1px rgba(255,255,255,0.04),var(--shadow-elevation-1);transition:transform .3s ease}
body.dark-mode .onyx-dock{background:linear-gradient(to top, rgba(255,255,255,0.06), rgba(255,255,255,0.02)),var(--glass-bg-dark);border-color:color-mix(in srgb,var(--glass-border-dark) 60%,transparent);box-shadow:inset 0 1px 1px rgba(255,255,255,0.05),var(--shadow-elevation-2)}
.onyx-dock .dock-item{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4px 10px;border-radius:22px;transition:all .22s ease;color:var(--text-color);opacity:.9}
.onyx-dock .dock-item:hover{opacity:1;transform:translateY(-1.5px)}
.onyx-dock .dock-item.active{color:var(--accent-color);background:color-mix(in srgb,var(--accent-color) 25%,transparent);box-shadow:0 0 12px color-mix(in srgb,var(--accent-color) 35%,transparent),inset 0 0 0 .5px rgba(255,255,255,0.12);opacity:1}
.onyx-dock .dock-icon{width:20px;height:20px;margin-bottom:3px}

/* Toasts */
#toast-container{position:fixed;bottom:30px;right:30px;display:flex;flex-direction:column;gap:12px;z-index:9999}
.toast{background:color-mix(in srgb,var(--accent-color) 25%, #000);color:#fff;padding:14px 20px;border-radius:12px;font-size:15px;box-shadow:0 6px 25px rgba(0,0,0,0.25);animation:toastFadeIn .36s ease,toastFadeOut .36s ease 3.5s forwards;backdrop-filter:blur(10px)}
@keyframes toastFadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
@keyframes toastFadeOut{to{opacity:0;transform:translateY(20px)}}

/* Accessibility & focus */
:focus-visible{outline:var(--focus-outline);outline-offset:4px;border-radius:.375rem}
body.focus-outline-disabled :focus-visible{outline:none !important;outline-offset:0 !important}

/* Motion control */
.motion-disabled *{transition:none !important;animation:none !important}

/* Responsiveness */
@media (max-width:768px){
  .setting-card{flex-direction:column;align-items:flex-start;gap:.75rem;padding:1rem}
  .custom-background{flex-direction:column;align-items:center;text-align:center}
  .custom-bg-controls{justify-content:center}
  .custom-bg-separator{width:80%;height:1px;margin:1rem 0;transform:scaleX(.9)}
  #customBgPreviewContainer{width:95px;height:95px}
}
@media (max-width:430px){
  .ios19-bubblebar{width:calc(100% - 1.25rem);padding:.55rem .65rem}
  .ios19-bubblebar .tab span{font-size:.8rem}
}

/* Small utility classes */
.hidden{display:none!important}
.visible{display:block!important;opacity:1;transform:none}

/* High contrast tuned elements (explicit) */
body.high-contrast .setting-card,
body.high-contrast .settings-subsection,
body.high-contrast .glass-card{
  background: color-mix(in srgb,var(--glass-bg-dark) 92%, transparent);
  border:1px solid var(--glass-border-dark);
  box-shadow:0 4px 24px rgba(0,0,0,.65), inset 0 0 12px rgba(255,255,255,0.08)
}

/* Color-warning (kept and tuned) */
.color-warning{width:100%;margin-top:1rem;padding:.75rem 1rem;background:#fffbe6;color:#9c6f00;border:1px solid #ffe58f;border-radius:8px;font-size:.875rem;box-sizing:border-box}
body.dark-mode .color-warning{background:#4d3c1a;color:#ffeca7;border-color:#8b6b1f}

/* End of optimized stylesheet */
